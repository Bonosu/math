\documentclass[11pt,a4paper]{jsarticle}
%
\usepackage{amsmath,amssymb}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{ascmac}
%
\setlength{\textwidth}{\fullwidth}
\setlength{\textheight}{40\baselineskip}
\addtolength{\textheight}{\topskip}
\setlength{\voffset}{-0.2in}
\setlength{\topmargin}{0pt}
\setlength{\headheight}{0pt}
\setlength{\headsep}{0pt}
%
\newcommand{\divergence}{\mathrm{div}\,}  %ダイバージェンス
\newcommand{\grad}{\mathrm{grad}\,}  %グラディエント
\newcommand{\rot}{\mathrm{rot}\,}  %ローテーション
%
\title{脳を学ぶ上で大事な数学シリーズ}
\author{後藤 優仁}
\date{\today}
\begin{document}
\maketitle
%
%
\section{はじめに}
\subsection{本書の主旨, 自己紹介}
さて, この資料を覗いている貴方は, 実学(さいあんす)を重視する優秀な塾生であるのでしょう！！すばらしい！！！\\
\\
慶應義塾において, 塾生同士の繋がりは尊ぶべきであり, その立場に関わらず学び教えあう 半学半教 の精神が大事であると福澤先生は仰っております. \\
\\
よって僕も, 未熟者ではありますが後進の育成のため, ひいては将来僕に教えてくれうる人材への先行投資として, この資料を作成することにしました. 脳は学ぶにはあまりにも難しく, 脳を学ぶ事で脳を病んでしまうものですが, ともに頑張りましょう！ \\
\\
最初にことわっておくと, 本書ではある程度までの分かりやすさを担保しますが, 逆にある程度以上は「自明」で片づけます. 初学者はもちろん「自明じゃねえよふざけんな！」と思う事でしょうが, このイラ立ちが大事なのです. 自明なものを自明と思えないという事は, 読者の理解力・基礎力が足りていないという事です. \\\\
分からなかった単語や数式をググり, 本を借り, 先生や先輩に聞き, 手計算で確認し, 実装してプロットした結果を眺める...このようにして崇める事で, いつしか調べていた事が自明であった事に気付けるようになります. 中学数学に対して「自明じゃねえよ」なんて考える人はいませんね？それと一緒です.\\
\\
\\
さて筆者のプロフィールですが, 脳神経科学歴1年, 数学歴半年のペーペーです. 数学に至っては半年前は虚数が何か分からなかったし三角関数の意味も知りませんでした.\\
よって変な理解だとか知識の抜けもあると思うのでご指摘お待ちしています.\\

\subsection{本書のカバーする内容}
本書は筆者の気が向いた時に少しずつ更新していくので, タイミングによってはほとんど書いてないと思いますが, 最終的に目指している点をここに記します.\\
\\
基本的には脳神経科学, 特に脳波を用いる際に必要になってくる数学を全体集合として, 部分集合を小出しにだしていく感じを考えています. 補集合については更新を待つか諦めて独学をする, あるいは筆者に書くよう申請をしてください. 従って本書のカバーする内容はおおまかに分けて\\
\\
\begin{itemize}
 \item 前提となる基礎的な数学
 \item 脳波を代表とした信号を処理する信号処理数学
 \item ANOVAやt検定, 簡単な機械学習などの統計的数学
\end{itemize}

などといった感じになると思います. 軟弱なSFC生の多くはいらないと考えるでしょうが, 少なくとも他大学の脳科学の研究室ではどれも児戯のごとき基礎となっています(実際学部1.2年で大体やってる). がんばりましょう.
\\
\\
\section{基礎を学ぶ}
\subsection{掛け算}
\subsection{掛け算とは何か}
掛け算とはとても難しいものです.\\
何故なら, 足し算はユークリッド空間から離れた複雑な空間でも, 大抵は普通にこなすことが出来ますが, 掛け算はユークリッド空間をほんの少し離れてしまっただけで難解になってしまうからです. \\
\\
逆に言うと足し算では違いが分からない様々な空間も, 掛け算で考えると全く異なる空間であった事が理解できるとも言えます. \\
ちなみに, 割り算になると難しすぎて頭が爆発します. \\
引き算が足し算で表せるのは自明なので割愛(割り算も掛け算で表せるだろと思った君, すまない僕もそう思う. ただ難しいらしい.)\\
信号処理や統計の勉強をしていくには, 掛け算は非常に大切なものです. まずは掛け算の偉大さと深淵に触れましょう.\\
\\
\subsubsection{数ってなぁに？}
先程, ユークリッド空間やらなんやらといった言葉が出てきましたが, 簡単にいうとこれらは全て別の「数」として案が得る必要があるため, 空間と名付けています.\\
まずは単一の数と複数の数に分けるところからいきましょう.\\

\subsubsection{単一の数スカラー}
単一の数, スカラー数です. 高校での数学を真面目に受けていた人間なら聞き覚えがえるでしょう. スカラー数とは最も簡単な数...すなわち僕達が昔から親しんできた「数」のことです！\\
簡単ですね！以上です.\\
\\
スカラー数の掛け算は僕たちが直感的にやっている
\begin{eqnarray}
3 * 5 = 15
\end{eqnarray}

の事です.
\\

\subsubsection{複数の数からなる積}
複数の数からなる数には色々あります.\\
\begin{itemize}
 \item ベクトル
 \item 複素数
 \item 行列
\end{itemize}

等です. これらはスカラー数の掛け算とは全く違う世界になります. 心してかかりましょう. 高校以上の数学は非常に難しいもので, 僕も全く分からずにおいて行かれましたが, どうにか理解するための最初の第一歩は, 「世の中には(スカラー)数じゃない数があるらしい」と知る事です. 僕はこれを理解するまでに4年の歳月を費やしてしまいました. \\
\\
では, そもそも何故スカラー以外の数を考える必要があるのでしょうか？\\
普通に生きていてベクトルや複素数といったものを自然の中に見る事はないでしょう(あるいは啓蒙を高めると見る事が出来るのやもしれない).\\
しかしスカラー数には限界があるのです. 何故なら, 基本的にスカラー数とは直線であるからです！ \\
\\
0があって1があり, その次に2が来るのは小学2年生の数直線ですが, 小学4年生頃には「どうやら0と1の間にも小数や分数があるらしい」と知ります. 次に中学になり, 0の向こう側には同じだけの数の負の数があり, 更には√がつく数などもある事を知ります. そして少し飛びますが高校では, 数直線の右と左に終わりはなく, 無量大数という領域に飛んでいる事を知る. ここまでがスカラーの学習順序ですが, いずれも1本の直線を細かく見たり, あるいはずっと先を見ているだけな事に気付くでしょう. \\
\\
ただの直線であるスカラーでは記述できる情報が少ないため, 不都合があるから別の数を考える必要があったわけです. スカラーっぽいやつらを複数束ねてまとめた「数」を新しく定義してやれば表現できる情報量は各段に増え, 世界が広がります. \\
\\
記述する要素が増えれば情報が増えるのは自明ですね.
\\
\subsubsection{ベクトルの積}
ベクトルとは二次元の場合は2つ, 三次元の場合は3つの数を束ねたものです. \\
数を複数束ねると, その間に比が生まれ, 角度が生まれます. \\
これが先述した, 増える情報量であり, スカラー数との決定的な違いです.\\
\\
ベクトル同士を掛け合わせるとき, どうするでしょうか？\\
一番素朴な形は下記の通りでしょう.\\
\begin{eqnarray}
(\mathstrut x_1 , \mathstrut y_1)(\mathstrut x_2 , \mathstrut y_2 ) = (\mathstrut x_1 \mathstrut x_2 + \mathstrut y_1 \mathstrut y_2)
\end{eqnarray}

これをベクトルの内積と言います.\\
そして, これは2つのベクトルの絶対値の積に互いになす角の cos をかけたものと同値です. 確認してみましょう.\\
\\
ある2つのベクトルを考えてください.\\
1つは $(\mathstrut r_1\cos x , \mathstrut r_1\sin x)$ で, もう一つは 
$(\mathstrut r_2\cos y , \mathstrut r_2\sin y)$ です.
\\
全ての比は cosx:sinx で表せるので上記の表し方が大丈夫なのは自明です.\\
\\
では内積を考えます.\\
\\
\begin{eqnarray}
(\mathstrut r_1\cos x, \mathstrut r_1\sin x)(\mathstrut r_2\cos y, \mathstrut r_2\sin y) = \mathstrut r_1\mathstrut r_2(\cos x\cos y + \sin x\sin y)
\end{eqnarray}

加法定理より
\begin{eqnarray}
\mathstrut r_1\mathstrut r_2(\cos x\cos y + \sin x\sin y) = \mathstrut r_1\mathstrut r_2\cos (\mathstrut x- \mathstrut y)
\end{eqnarray}

加法定理が成り立つのはオイラーの公式より自明です.\\
たしかに絶対値の積とcosをかけたものになっていますね. ここからベクトルの内積というものが何を表しているのかが分かるのですが, いったん置いといて次へ進みます.\\

\subsubsection{sin cos そして直交}
２つのベクトルが直交するとき, 積は0になります.\\
証明\\
\\
ここで, y が x + π/2であると仮定します.\\
\begin{eqnarray}
\cos y = \cos (\mathstrut x + \pi/2) = -\sin x
\end{eqnarray}
\begin{eqnarray}
\sin y = \sin (\mathstrut x + \pi/2) = \cos x
\end{eqnarray}

\begin{eqnarray}
(\mathstrut r_1\cos x, \mathstrut r_1\sin x)(\mathstrut r_2\cos y, \mathstrut r_2\sin y) = \mathstrut r_1\mathstrut r_2(\cos x\cos y + \sin x\sin y) = 0
\end{eqnarray}
このように, 直交するということは内積が0になるということだと証明できます. 当然xとyの大小関係が逆でも成り立ちます.\\
\\
少し余談になりますが, 実はこれものすごく偉大ですごい事なのです. ベクトルの直交は内積が0という事は２次元ベクトルなら自明ですね. しかしこの性質は２次元に限らないのです. つまり無限次元のベクトルがあっても, その直行性について定義できちゃうのです！！！\\
\\
やばいですね！\\


\subsubsection{ベクトルの積再訪, 外積}
さて, まだよくわかりませんね. \\
先程てきとうに書いた「素朴な積」は内積ですが, x同士y同士の掛け算でした.\\
何故こうなるのでしょう...? xとyをかけても良さそうですよね.\\
\\
ここはあまり必要ありませんが, x と y を掛け合わせたときに出てくるのは内積に対して外積といいます.\\
\\
内積に対してcos が sin になります.
\\
\\
証明\\
上記と同様に加法定理より\\
\begin{eqnarray}
\mathstrut r_1\mathstrut r_2(\cos x\sin y + \cos y\sin x) = \mathstrut r_1\mathstrut r_2\sin (x-y)
\end{eqnarray}
簡単ですね.


\subsubsection{内積と外積の意味}
内積と外積の定義を見てきましたが, その意味とは何でしょう？\\
内積はcosがついていますね！\\
cosがついているというのは非常に大切です.\\
cosというのは「同じ方向を向いてたら正, 直交してたら0, 反対なら負」なのです.\\
つまり以心伝心～犬猿の仲なのです. 右脳と左脳のようなものですね(正か負かは言わない)\\
このように関係性のものさしとしてxx + yy を使うのが内積です！\\
\\
外積は何かって？\\
sinがついています. つまり, どれくらい無関心でいるかの指標ですね！

\subsubsection{その他の演算}
ベクトルの掛け算のうち, ここでは扱わないが非常に重要な定義の一つとして, ドット積があります. \\
ドット積とは, 同じ長さの数列の各要素を掛け合わせ, その値を足し合わせて一つの値として出力したものです.\\
\\
そう, つまり内積の事ですね！！\\
ドット積は実質(ユークリッド空間では)内積と同じ扱いをされます.\\
\\
こいつは代数学・幾何学において非常に大事になる上, 畳み込みの基礎となるものです！\\
\\
そしてそれはつまり, フーリエ変換やウェーブレット変換の基礎になる偉大な掛け算です！！！
\\
ベクトルの掛け算を学ぶ意味は, 畳み込みを理解しフーリエ変換を理解する事にあるのです！！\\
凄いですね！！\\

\subsubsection{複素数の積}
上記ベクトルと同様, 複素平面上では $\mathstrut r (\cos x + \mathstrut i\sin x)$ というものを考えます.\\
上記同様, 一般的な積を考えてみましょう.\\

\begin{eqnarray}
\begin{split}
\mathstrut r_1(\cos x + \mathstrut i\sin x)\mathstrut r_2(\cos y + \mathstrut i\sin y)\\
= \mathstrut r_1\mathstrut r_2(\cos x\cos y - \sin x\sin y + \mathstrut i\sin x \cos y + \mathstrut i\cos x\sin y)
\end{split}
\end{eqnarray}

上記は加法定理より
\begin{eqnarray}
\mathstrut r_1\mathstrut r_2(\cos (\mathstrut x + \mathstrut y) + \mathstrut i\sin (\mathstrut x + \mathstrut y))
\end{eqnarray}
となります.\\
\\
ベクトルの内積と似てはいますが, 決定的な違いがあります.\\
掛け算をすると角度の足し算になっているのです！\\

\subsubsection{複素数の逆数}
地味に複素数の偉大なところです.\\
逆数...つまり$\frac{1}{x}$が出来れば割り算はできますよね？\\
ベクトルや行列は複数の数を束ねただけなので逆数と言われてもこまりますが, 複素数は割り算が簡単にできます. \\
何故なら複素数は見た目上スカラーっぽいですからね！\\
逆数を取るという事は, 複素数の割り算は角度の引き算になりますね.\\

\subsubsection{複素平面の掛け算の意味}
複素平面で掛け算をすると角度の足し算になるようだ！\\
つまり回転ですね. これの何がうれしいかって言うと, 計算が超楽になるのです.\\
\\

そしてこの性質が大正義であるオイラーの公式に, 必然か神の悪戯か, 結びついているのです.
\subsubsection{大正義オイラーの公式}
証明は別の資料にしますが, 人類の至宝とされ, 僕が師匠に最初におそわった偉大な魔術である, オイラーの公式です. 刮目せよ.\\
\begin{eqnarray}
\mathrm{e}^{ix} = \cos x + \mathstrut i\sin x
\label{eq:euler}
\end{eqnarray}
美しいですね！\\
更にこいつの特殊形がこうなります.\\
\begin{eqnarray}
\mathrm{e}^{i\pi} + 1 = 0
\end{eqnarray}
美しすぎますね！！\\
\\
この人類の至宝をもって, 我々は脳波と戦っていくことになります.\\
Euler's formula を制するものは脳を制するのです.\\
具体的に言うとドット積同様, フーリエ変換の基本の一つになっています. \\
そしてフーリエはウェーブレットの基本となっています！！\\
そしてウェーブレット変換はヒルベルト変換の基本なのです！！\\
そしてヒルベルト変換まで理解した君は気付くのです. 脳波解析とはなんだったのか, その有難みと問題点に！！！\\

\subsubsection{行列とは何か}
行列とはただの数字の羅列..そう思っていないか？\\
その通りです.\\
しかしせっかく今までベクトルと複素数の掛け算の意味を考えてきたので, 行列でも意味を考えてみましょう.\\
\\
行列の内積とは, 実は連立方程式を表しているのです！！\\
凄いですね！！\\
さらにさらに, 行列の内積は回転でもあります！\\
超すごいですね！！！\\
\subsubsection{行列の内積}
すまん. Texで記すのめんどう. 
\\
ググれ.
\\
要は縦 * 横だ.\\

\subsubsection{ベクトルの内積の拡張としての内積}
ベクトルの内積はx,yをそれぞれ対応するやつ同士かける事でした.\\
行列の場合は...なんと, 横２列同士, 縦2列同士の掛け算はできないのです...\\
\\
ここが行列の厄介なとこであり, 僕が完全に理解できてない所以でもあるのですが, 行列はすごい性質（上記）をもっているが積の交換法則
\begin{eqnarray}
xy = yx
\end{eqnarray}
がぶっ壊れてる世界なのです. なんかすごいですね！！\\
行列の世界では交換法則が成り立たないため, 行列でベクトルの内積を計算する際には順番をしっかりと守らないといけません.\\

\subsubsection{連立方程式としての行列}
連立方程式は大丈夫ですね？
\begin{eqnarray}
a_1x + b_1y = c_1
\end{eqnarray}
\begin{eqnarray}
a_2x + b_2y = c_2
\end{eqnarray}
このような奴らですね. よく見てください.
\[
  \left(	
  \begin{array}{cc}
  a_1 & b_1 \\
  a_2 & b_2
  \end{array}
  \right)
  \left(
  \begin{array}{c}
  x \\
  y
  \end{array}
  \right)
  =
  \left(
  \begin{array}{l}
  c_1\\
  c_2
  \end{array}
  \right)
\]
このような式になっているのです！\\
つまり, 行列を解くということは連立方程式を解くことに他ならないのです. これは機械学習とかやりたければ圧倒的に崇めるべき基礎です.\\
ちなみに, この解くという行為には逆行列や一般化逆行列を用います. 一般化逆行列は解が定まらないはずの時にごり押しで最適解をだしてくれるやつです. ムーアペンローズが有名ですね！\\

\subsubsection{行列の積の回転の性質}
行列の積を計算することは知らず知らずのうちに複素平面みたいに回転する事です. \\
次の行列を見てみましょう.\\
\[
  \left(	
  \begin{array}{cc}
  \cos x & -\sin x \\
  \sin x & \cos x
  \end{array}
  \right)
  \left(
  \begin{array}{c}
  \cos y \\
  \sin y
  \end{array}
  \right)
  =
  \left(
  \begin{array}{l}
  \cos x\cos y - \sin x\sin y\\
  \sin x\cos y + \cos x\sin y
  \end{array}
  \right)
  =
  \left(
  \begin{array}{c}
  \cos x + \cos y\\
  \sin x + \sin y
  \end{array}
  \right)
\]

行列の積は回転をも意味するのです！うーんよくわからん！\\
けどなんかすごそう！！\\
\\
行列の掛け算が脳にどうやって役に立つかって？\\
\\
僕もよくわかってない. 今後の勉強課題だなぁ.\\
やはり回帰とかに使うからか？あるいは活動源推定？\\
\\
誰か教えてください.\\
\subsubsection{最後に}
掛け算について習いたての身ですが駆け足でまとめました. といってもほとんど昔師匠にいただいた資料の焼き直しですが. \\
謎だ. やはりよく分からない.\\
掛け算について理解をする事は, 信号処理やデータ処理をするためにとても大切なことです. むつかしい数学をやるためには必須事項です. 特に複素数の偉大さ, オイラーの公式の神々しさに早めに気付く事は, 脳の理解への大きな一歩となります.\\
がんばっていきましょう.\\
\\
需要があれば続編を出していくぞ！\\

\subsection{三角関数}
\subsubsection{三角比とは}
三角関数の前に, まずは三角比から復習しましょう. 三角比とは, $\sin x$や$\cos x$ $\tan x$といった具合に三角形の辺の比を表す幾何学の方法でした. 直角三角形を考えた時, 横の長さがcos, 縦の長さがsin, そして斜辺の長さがtanで表せるのでした. \\
\\
あくまで辺の比としてだせるので, あとで絶対値分かける必要がありますが, それでも非常に便利なものです. 高校数学では, 結局辺の長さや比を覚えているものでしか使えないため, 三角比の勉強をする意味に苦しんだことと思います.\\
\\
\begin{eqnarray}
\sin 45^\circ = \frac{1}{\sqrt{2}} = \sqrt{2}
\end{eqnarray}
\begin{eqnarray}
\cos \pi = -1
\end{eqnarray}
こんなやつですね！\\
\\
sinが縦, cosが横, そしてtanが傾きを表しているので, 基本的な直角三角形であればその場ですぐ計算できますね？\\
\\
\subsubsection{三角比の公式}
三角比には, いくつか公式があります. ここを暗記で片づけるのは阿呆のする事です. いったん確認してみましょう.
\begin{eqnarray}
\tan \theta = \frac{\sin\theta}{\cos\theta}
\label{eq:tan}
\end{eqnarray}
\begin{eqnarray}
\sin^2 \theta + \cos^2\theta = 1
\label{eq:square}
\end{eqnarray}
\begin{eqnarray}
\tan^2\theta + 1 = \frac{1}{\cos^2\theta}
\label{eq:tan2}
\end{eqnarray}
式(\ref{eq:tan})については自明ですね. 傾きです.\\
式(\ref{eq:square})も自明です. ピタゴラスの定理です.\\
式(\ref{eq:tan2})は一寸ややこしいですが, 式(\ref{eq:square})を用いれば秒で片づけられます. \\
このように, 三角比の公式というのはおまじないではなく, 常識なのです. 10+20を暗記する人はいませんね？\\



\subsubsection{三角関数}
さて, 三角比がどんなものか分かったうえで, それぞれの三角比を関数として考えてみます.\\
\\
 $\sin x $はxが$0 + 2\pi n$の時に0, $\pi/2 + 2\pi n$の時に1, $\pi + 2\pi n$の時に0, $3\pi/2 + 2\pi n$の時に-1を常に通り, その間を滑らかな曲線で結んだ関数になります. n の値は何周目かを表します.\\
\\
$\cos x $も同様にして1,0,-1,0となっています. \\
\\
$\tan x$ は一寸特殊で, 三角形の斜辺の傾きを表すという性質上, 端がありません. よって x = 0の時には0, で正負方向に対称で$\pi/2 + \pi n$で$\infty$ または $-\infty$ を極限としてとんでいきます.\\
\\
ここまでは常識ですね？今時小学生でも知ってるかもしれません.\\
\\
さて, こいつら三角関数の何がすごいかって, 超単純な周期関数である事です. \\
さらに, 実は sin と cos に限って言えば位相が違うだけでその形は全く同じなのです！！！みていてください.\\
\\
\begin{eqnarray}
\cos x = \sin (x + \pi/2)
\end{eqnarray}
こうなっているのです！！やばいですね！！！
\\

\subsubsection{加法定理}
これはオイラーの公式を用いる事で, 覚えていなくてもその場で導出できます. みててください.
\begin{eqnarray}
\mathrm{e}^{i{\alpha + \beta}} = \cos (\alpha + \beta) + i\sin (\alpha + \beta)
\label{eq:aplusb}
\end{eqnarray}
指数法則より,
\begin{eqnarray}
\begin{split}
\mathrm{e}^{i{\alpha + \beta}} &= \mathrm{e}^i\alpha + \mathrm{e}^i\beta \\ &= (\cos \alpha + i\sin\alpha)(\cos\beta + i\sin\beta) \\
&= (\cos\alpha\cos\beta - \sin\alpha\sin\beta)\pm i(\sin\alpha\cos\beta + \cos\alpha\sin\beta)
\end{split}
\label{eq:kahou}
\end{eqnarray}
ここで再び式(\ref{eq:aplusb})と見比べると, 式(\ref{eq:kahou})の実部がcos, 虚部がsinの加法になっている事が分かります. ここから三角関数の加法定理は
\begin{eqnarray}
\sin (\alpha + \beta) = (\sin\alpha\cos\beta + \cos\alpha\sin\beta)\\
\cos (\alpha + \beta) = (\cos\alpha\cos\beta - \sin\alpha\sin\beta)
\label{kahouteiri}
\end{eqnarray}

と証明できます. 例のごとくtanは一寸面倒なので, 自分で証明してみてください.
\subsubsection{正弦と余弦}
sinとcosの関数の定義は分かりましたが, それがなんで嬉しいのでしょうか？\\
これを知るためには, sinとcosの関係はどんなものがあるのか考える必要があります.\\
\\
ここで前回やった掛け算が出てきます. \\
任意のsin関数とcos関数の積を考えてみます.\\
\\
$r_1\sin mx $と $r_2\cos nx $です.\\
\\
ここで$r_1$, $r_2$は振幅, mとnは角周波数を示していますので, 異なる周波数の三角関数になっています.\\
\\
こいつらの掛け算を考え, さらにそいつを積分してみます.\\
\\
\begin{eqnarray}
  \int^\infty_{-\infty} r_1\sin mx r_2\cos nx dx = \int^{2\pi}_0 r_1\sin mx r_2\cos nx dx = 0
\end{eqnarray}
\\
三角関数は $2\pi$周期で同じ波形の繰り返しになっているので, 範囲が$\infty$ から$-\infty$じゃなくていいのは自明ですね.\\
\\
三角関数は周期関数なので, それぞれが積分すると0なのは自明ですが, 更に積の積分も0になるのです！！！\\
これはすごい！！\\
\subsubsection{関数の内積}
さて, ここで掛け算の復習です. ベクトルの内積の定義を覚えていますか？\\
\\
そう, 対応する次元の要素を掛け合わせたものの総和でしたね！\\
\\
これ...関数でも使えそうじゃないですか！？\\
同じxの値の時のy同士をかけ, それの足し合わせをするのもやってる事は同じなのです！！\\
\\
\\
これを使うと, すごい事がおきます. そう. 関数に内積を定義できるのです！！すばらしい！！\\
ただし注意する必要があるのは, ベクトルでは総和をΣで表していましたが, 関数の場合はxが離散値ではなく連続値をとるため, 総和はΣでなく∫で表すという事です.\\
\\
いずれにせよ, 掛け算の総和で内積を定義できる事に変わりはないです. これは崇める必要がありそうですね！！\\
\\
そしてもう一つ, ベクトルにおいて内積が0になるとどうなっていましたか？\\
そう, 直交です！！！\\
\\
ベクトルの内積を関数の内積に拡張する事ができ, ベクトルの内積が0という事は直交を表す...すなわち関数についても直行性を定義する事が出来るのです.\\
\\
sinとcosは直交する関数なんですね！！！すごい！！
\subsubsection{直交性}
ここでは関数の直行性については細かい話は省きますが, 直交する関数２つ(sinとcos)を用意できたなら, これを使えばすべての関数を表す事が出来ます.\\
\\
そりゃそうですよねー. 複素数や直交座標系と同じノリです.\\
\\
つまり...全ての(周期)関数は, 異なる振幅, 周波数の三角関数の足し合わせによって表す事ができるのです！！！すばらしい！！！すばらしすぎますね！！！\\
\\
\subsubsection{フーリエ変換への一歩}
前項での内容を式に表すとこうなります. よく見てください.
\begin{eqnarray}
f(x) = \sum_{n=1}^\infty {a_n \sin(nt) + b_n\cos(nt)}
\label{eq:sum}
\end{eqnarray}
ここで, 式(\ref{eq:sum})はすべてsin,cosの値が0になる角度の際に吐き出される値も0になるものですが, 実世界においてはそううまくはいかず, DC電源につないでいたらその分基準値が上昇します. そこで式(\ref{eq:sum})を改造します.

\begin{eqnarray}
f(x) = a_0 + \sum_{n=1}^\infty {a_n \sin(nt) + b_n\cos(nt)}
\label{eq:fixed_sum}
\end{eqnarray}

ここで$a_0$はDC電源の分です.\\
\\
脳波は時間によって変化する時間関数ととらえる事が出来るので, この方法で脳波を三角関数に分解して表現する事が出来るのです！！！\\
\\
これが三角関数を崇める理由です.\\
\\
そしてこの, 時間関数f(t)を三角関数の和に変換する事をフーリエ変換といいます. 詳しくは今度.\\
\subsubsection{大正義オイラーの利用}
とはいえ, 三角関数を$∞$に足し合わせるというのも酷な話で, 計算が面倒なこと面倒なこと...\\
\\
どうにかならんもんか...\\
\\
ん？三角関数の足し合わせ？ どこかで聞きましたね？\\
そう, 式(\ref{eq:euler})に表した, 我らが至宝オイラーの公式です！！！\\
\\
オイラーの公式を用いる事で, 三角関数の足し合わせは指数関数で表せます. これを使う事で劇的に計算を楽にする事ができるのです！\\
ただ, オイラーの公式にはsinの前に謎の記号 i がついています. 一体こいつはなんなのでしょう. 次の節では, 虚数と複素数について学びます.\\

\subsection{複素数}
複素数とは偉大なものであり, 最初は理解に非常に苦しむものです. ですが複素数をマスターするという事は, 整数から分数への拡張や, 正の数から負の数への拡張を遥かにしのぐ恩恵を与えてくれるのです. 高校で習う内容ですが, ここでもう一寸深く学んでみましょう！\\
\subsubsection{虚数}
虚数の定義からおさらいをしましょう. 高校で習う領域の中でも, 比較的簡単だったはずです.\\
\\
虚数とは, 平方すると-1になる数を基底とした数の事です.\\
\\
1本の直線でしかない実数の問題は, 表現の幅が圧倒的に限られてしまう事です. そこで昔の人類は, 実数軸を2本重ね合わせた直交座標系やベクトルといった考えを用いたわけです.\\
\\
しかし, 虚数の登場がこの常識を大きく変える事になりました！！\\
\\
ベクトルあるいは行列を少し復習しましょう.\\
これらにおいて, 次元はどうやって定義されていたでしょうか？ 直交性・独立性ですね！！！\\
\\
実数ではない...0の時以外に必ず実数と交わらず, 直交性をもった「数」を定義できないか？
昔の偉い人はこう考えたのです. 頭おかしいですね！！\\
\\
こうして生まれたのが虚数単位iです. 実数において単位として利用される1の概念と直交する必要があったため, ここで1の平方が1である事に注目しました. \\
\\
平方して負の値になる数は存在しない. これは中学で習う事ですがこれを厳密に言うと, 「従来の数には存在しない」と解釈したわけです.\\
\\
そこで, 平方して負の値になる数を考え, これを虚数と名付けました.\\
実数の単位が1なら, 虚数の単位は1iとなります. 虚数も0の平方にマイナスをつけようとしたところで0なので, 実数と虚数は0で直角に交わる事になります.\\
\\
これが虚数の定義ですね！！ 高校数学では「存在しない数」などと習いますがこれは誤解を招きます. 虚数の意義とは「y軸」を定義できる事にこそあるのです！！！\\

\subsubsection{虚数の性質}
虚数は単位iがついてるだけなので, 基本的な足し算引き算はすべて実数と同様に扱えます. 簡単ですね！\\
\begin{eqnarray}
3i + 5i  =(3 + 5)i = 8i
\end{eqnarray}
掛け算になると一寸難しくなり, 虚数同士をかけると数字同士の積にマイナスをつける必要があります. それが虚数の性質でしたね！\\
\begin{eqnarray}
3i * 5i = (3*5)i^2 = 15 * -1 = -15
\end{eqnarray}
\\
この掛け算, 実は複素数の掛け算の性質を考えると自明になります.\\
この章の最後でそれを説明します！\\
\subsubsection{複素数}
虚数のおさらいができたところで, 複素数です. 実数も虚数も直線であるため, これらを軸として, 直交座標系っぽいものを考えます.\\
\\
こうしてできた平面の事を, 複素平面やガウス平面といいます.\\
\\
さて, ガウス平面を考えた際, とてもうれしい事が数多くあります. まずはそれぞれの軸における長さですが, 実数も虚数も単位が1(i)であるため, 原点からの距離を考えると $ |x| = |xi| $ になっているのです. \\
\\
この性質を利用すると, ガウス平面上の任意の点を直交座標の点に対応づける事ができ, (x, y) ≒ x + yi といった具合に表す事が出来ます. \\
\\
このように, 実数部分と虚数部分の足し合わせによって, 複素平面（二次元）上の数を表現した数を複素数といいます.\\
\\
こいつのうれしさは, 直交座標や行列のように複数の数の集まりではなく, ひとつの数として扱える点です！！！\\

\subsubsection{数の大幅な拡張}
複素数の定義が分かったところで, これが実際にどうやって影響してくるのかについて考えます. 一次元が二次元に拡張されたわけですからその恩恵は計り知れません. \\
\\
さらに複素数の偉大な点は, 実数を複素数の一部として扱える点です.\\
\\
たとえば3は, 複素数で表すと 3 + 0iとなります.\\
そして注意しないといけないのは, 複素数を実数に変換した場合, その虚数成分は捨てられてしまうのです！！\\
実軸に投射される過程で, 虚軸(高さ)成分は消えてしまうという事です.\\
\\
つまり...\\
我々が今まで3だと思ってた数は, 実は 3 + 5i かもしれない...という考え方もできます！！\\
\\
ちょっと違うような気もしますが, たとえば大学の単位で考えましょう.\\
成績がCでもSでも, 来る単位は1です.\\
\\
実軸を単位, 虚軸を成績とすると, 実軸だけではCの人もSの人も同じ優秀さぽく見えますが, 虚数成分も合わせれば同じ単位取得者でも上下関係があった事に気付けるわけです！！\\
\\
複素数は偉大ですね！！
\\
実はこの考え方が後にウェーブレット変換を学ぶ際に非常に重要になるのです. 頭の片隅においておいてください.\\

\subsubsection{複素数平面}
複素数平面において, 任意の点 x + yi を表す方法について考えていきます. \\
\\
実軸と虚軸の直行性より, 複素数 z = x + yi の横（実部Re）の長さ(\ref{eq:x})と, 縦（虚部Im）の長さ(\ref{eq:y}), 原点との距離(\ref{eq:length}), そして実軸との間になす角(\ref{eq:arg})はそれぞれ
\begin{eqnarray}
\mathstrut Re z = x
\label{eq:x}
\\
\mathstrut Im z = y
\label{eq:y}
\\
|z| = \sqrt{x^2 + y^2}
\label{eq:length}\\
\mathstrut arg z = \tan^-1 \frac{y}{x}
\label{eq:arg}
\end{eqnarray}
のように表されます. 長さについては直交座標なので自明ですね. 絶対値に関してもピタゴラスの定理より自明. 式(\ref{eq:arg})で表される角の事は, 偏角と言います. 実軸との角度の事であるので, tanを使って表す事が出来るというわけですね.\\
\\
また, 複素数 z を実軸に線対称な点を取った点の事を $ \overline{z}$ と表し, 複素共役な点といいます.\\

\subsubsection{極形式}
複素数 z は x + yi のような表記の仕方以外に, もう一つの表し方ができます.\\
\\
前節で確認した, 複素数 z の絶対値は, 原点との距離を表す実数でした. 範囲は0以上の実数になりますね！！\\
\\
偏角の取りうる範囲はどうなるでしょうか？\\
原点を中心として4つの象限をぐるぐる回るので, -π ～ πですね！\\
\\
\\
この2つに注目して考えます. 原点からの距離(r)と偏角($\varphi$)が分かるという事は, 平面上で一意に定まる点を定義できますよね？
\begin{eqnarray}
z = x + iy = r(\cos \varphi + i\sin \varphi)
\label{eq:kyoku}
\end{eqnarray}

$r\sin\varphi$ で導出される数は実数(y)になっているため i をかける事を忘れないように.\\

\subsubsection{大正義オイラー再び}
式(\ref{eq:kyoku})の最右辺をよく見てください. どこかで見た式ですね！！！\\
あぁ, オイラーあるいはユーラー...あなたはこんなところにまで...！！！\\
\\
人類の至宝を利用する事により式(\ref{eq:kyoku})はこのように変換する事が出来ます.\\
\begin{eqnarray}
z = x + iy = r(\cos\varphi + i\sin \varphi) = r \mathrm{e}^{i\varphi}
\end{eqnarray}

\subsubsection{複素数の掛け算}
さて, 複素数を $r\mathrm{e}^{i\varphi}$ で表せたところで, 何度か説明をしている複素数の掛け算を改めて考えます.\\
\begin{eqnarray}
\begin{split}
z_1 * z_2 = (x_1 + iy_1)(x_2 + iy_2)\\
&= r_1(\cos\theta_1 + i\sin\theta_1)r_2(\cos\theta_2 + i\sin\theta_2)\\
&= r_1r_2\mathrm{e}^{i\theta_1} \mathrm{e}^{i\theta_2}\\
&= r_1r_2\mathrm{e}^{i(\theta_1 + \theta_2)}
\end{split}
\end{eqnarray}

こうなっているのです！！！\\
複素数の掛け算は絶対値をかけた上の回転を表す. 自明でしたね！！！
\subsubsection{戻り学習}
ここで再び, 虚数とは何か, 何故平方すると-1になるのかを考えます.\\
任意の複素数を考えます. ここでは面倒なので $ 3 + 0i$ としましょうか.
\begin{eqnarray}
3 + 0i = 3(\cos 0 + i\sin 0) = 3(1 + 0) = 3
\end{eqnarray}
こんな感じに表せますね.\\
こいつにiをかけます. よく見ててください.
\begin{eqnarray}
i(3 + 0i) = 3i(\cos 0 + i\sin 0) = 3i(1+0) = 3i\\
\end{eqnarray}
そしてこいつと...
\begin{eqnarray}
3(\cos (0+\frac{\pi}{2}) + i\sin (0 + \frac{\pi}{2})) = 3(\cos\frac{\pi}{2} + i\sin\frac{\pi}{2}) = 3i
\label{eq:roll}
\end{eqnarray}
こいつを見比べるのです. 同じ値になってますね！！\\
複素数の積は回転を表すので, つまり i をかけるという事は $\frac{\pi}{2}$ 回転するという事なのです！！\\
\\
なのでもちろん式(\ref{eq:roll})にiをかけると, -3 になります. 虚数単位i を２回かけると-1を掛ける事になる, つまり $\pi$ 回転するのですね！\\
\subsubsection{まとめ}
このように三角関数と虚数は非常に親和性が高く, そしてオイラーの公式によって指数関数ともつながる非常に重要な概念になっています. \\
\\
三角関数と虚数を理解すれば, 脳波解析を学ぶ基礎となる数学はほぼ出そろったという事になります！！\\
しっかりと理解していってください！！\\

\subsection{微分・積分}
この章ではみんな大好き微分積分いい気分の気持ちを考えていきます.\\
高校数学で習うなかでも, とびっきり意味が分からない分野ですね.\\
\subsubsection{極限とは}
まず, 微分や積分といった計算は超極小の範囲で考える数学です. この超極小というのがなんなのかから考えます.\\
\\
超極小...曖昧な響きですね. 我々の身長の話をしている際にmmを持ってきたら極小と言えますが, 蟻の体長の話をしている時には大きすぎますね. \\
\\
このように, どんなスケールでの話をしていても十分に小さいといえるようなスケールでの話が微分積分です.\\
\\
実用では「０に限りなく近づく」などといった表現で表され, 数式だとこうなります.
\begin{eqnarray}
\lim_{x\to0} f(x)
\end{eqnarray}
この意味するところは, 関数f(x)のxを限りなく０に近付けた時の関数の返す値という事になります. つまり f(x) が 2x とかであれば
\begin{eqnarray}
\lim_{x\to0} 2x ≒ 0
\end{eqnarray}
になります. しかしここでxは限りなく0に近い値なので実質的にはこの式が返す値も0と見做せるので, 等号は成り立ち, 点々は外れます.
\begin{eqnarray}
\lim_{x\to0} 2x = 0\\
\lim_{z\to\infty} 2x = \infty
\end{eqnarray}
\subsubsection{ε-δ論法}
限りなく0に近いって曖昧な表現ですよね. さっきも言ったようにmmなのかμmなのか, どこからが限りないと言っていいのかわかりません. ここで極限
\begin{eqnarray}
\lim_{x\to a} f(x) = b
\end{eqnarray}
は数学語では
\begin{eqnarray}
\forall \varepsilon >0, \exists \delta>0  s.t.  \forall x \in \mathbb{R}, |x-a|<\delta \Rightarrow |f(x)-f(a)|<\varepsilon
\label{eq:ed}
\end{eqnarray}
のように定義されます. 有名なε-δ論法というやつを使うのです.\\
\\
この式の意味はこうです．\\
\\
「任意の正の数εに対し, ある適当な正の数δが存在し, $ 0 < |x − a| < δ$ を満たす全ての実数 xに対し、 $|f(x) − b| < ε$が成り立つ」\\
\\
f(x)とbの間の距離が任意の正の数εより狭い範囲において, 必ず対応するxの値が存在しているといった具合で, 「お前がどんなに頑張ろうと俺はその上をいく」みたいなやつです.
\\
\\
つまり極限とはmmなのかμmなのか？という問いに対する答えは, 「お前がmの話をするならcm, cmの話をするならmm, mmの話をするなら...」を死ぬまでやるイタチごっこだということです！！\\
\\
ちなみに式(\ref{eq:ed})はついでに関数の連続性についても定義していて, どんなに小さい範囲で見てもそれより小さい値が存在するという事は切れ目なくしっかりとつながっている＝連続であるという定義にもなります.\\

\subsubsection{微小な変化率}
さて, 極限とはある一点に限りなく小さい範囲を考える事でした.\\
ここで, 関数でも同じ事を考えます.\\
\\
まずはざっくりとした範囲で考えてみましょう.\\
\begin{eqnarray}
\lim_{0\to5} x = 5
\end{eqnarray}
この式の意味を考えてみます. 「xの値が0 から5に限りなく近づくとき, yの値は何になっていくか」ですね！\\
\\
ぶっちゃけて言えばxが５増えたらyはどんだけ増える？という問いで, それに対する答えが「５」だったわけです.\\
\\
変化する値が2つあったら, その間の比を求めたくなるのが健常な脳の持ち主です. xが増えた分に対してyがどれだけ増えたかを考えましょう.
\begin{eqnarray}
\frac{\Delta y}{\Delta x} = \frac{5}{5} = 1
\end{eqnarray}
こうですね. Δは増加分という意味です.\\
これ, あれですよね. 中学で習った変化の割合, またの名を平均変化率, またの名を傾きでした.\\
今回は傾き1の一次関数を例にしたので, 変化の割合もしっかり1になっています.\\
しかしこれが二次以上の関数だった場合どうなるでしょう？ 元が直線でないので, 重なる事はないはずです.\\
\begin{eqnarray}
\lim_{x \to a} f(x)
\end{eqnarray}
このうち, f(x)が二次以上の関数の場合は $|x-a|$の値が大きければ大きい程グラフの形を無視して串刺しにする線が引かれ, 小さい程グラフの縁の角度に近い線が引かれていきます.\\
\\
そしてこの値が一点に集中したとき, つまり$|x-a|$が0となったとき, それは点aにおける接線の式になるのでした.\\
\\
これはつまり, 超微小で見た変化率＝接線を求めているという事で, この操作をする事を微分と言います.\\
\\
微分とは, 局所的な微小変化率を求める事なのです！！！\\
「あたりまえだろお前高校数学やったか？」と思っただろ！！やってねえんだよ！！\\
\\
実際この微分の捉え方, よく理解できている人は多くないように思えます. かみしめてください.
\subsubsection{三角関数の微分}
上記の性質が分かっていれば, 簡単な公式達です. 覚えるまでもありません.
\begin{eqnarray}
(\sin x)' = \cos x \\
(\cos x)' = -\sin x \\
(-\sin x)' = -\cos x \\
(-\cos x)' = \sin x
\end{eqnarray}
\\
自明ですね. sin, cos関数それぞれがどういった挙動をしていて, その傾きをすべての点で取ってつなげていったらどうなるかを考えれば, 自ずと分かるはずです.\\
\\
「微分とは, 局所的な微小変化率を求める事」です.\\
\subsubsection{ネイピア数}
三角関数の次, 微分といったらこいつですよね. πと並び超越数として名高い e の出番です.\\
ネイピア数は別名オイラー数です. これだけで崇めないといけない気がしてきますね！？\\
\\
$(\mathrm{e}^x)' = \mathrm{e}^x$ つまり, 指数関数にしたときに微分しても値が変わらないという変態な数です.\\
\\
微分しても値が変わらないって, わけがわからないですよね. 微分とは傾きを求める事だとか, 体積から面積を求める事, といった理解をしていると全く訳がわからなくなります.\\
\begin{eqnarray}
e = \lim_{x\to 0} (1+x)^\frac{1}{x} = \lim_{x \to \infty} (1+\frac{1}{x})^x
\end{eqnarray}
定義としてはこんな感じです.\\
まぁここは良いです. 大事なのは指数関数を微分しても値が変わらないという性質の確認だけです.\\
\\
さて, 一般に正の1以上の数を底とする指数関数は, 第一象限で二次関数的な上がり方をし, (0,1)を通って, 第二象限ではx軸に漸近しつつ徐々に横ばいな形をとりますね？\\
\\
こいつを, x軸方向に様々な点で接線ぽいのを引き, 傾きを推測してみてください. \\
\\
面白い事に, こうやって求めた傾きの値をy成分として新しくグラフを書いた f(x)' も指数関数の形をしているのです！！\\
そしてこの形は, (0,1)だけは固定としてその開き方が底の値によって異なります. \\
底の値次第で, 微分したら開いた指数関数がでてくるものや, 細くなった指数関数がでてくるのです.\\
\\
もう分かりますね？ネイピア数とは, 丁度この開いたり閉じたりする境界にある数なのです！！\\
よって微分しても出てくる指数関数は開き具合を変えず, 重なった関数となるのです.\\
\\
ネイピア数の何がすごいかって？\\
いろんな数学に利用できるところです！！！\\
\begin{eqnarray}
\mathrm{e}^i\theta = \cos\theta + i\sin\theta \\
F(x)=\frac{1}{\sqrt{2\pi \sigma^2}}\int_{-\infty}^{\infty}\exp{\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}}\ \mathrm{d}x
\end{eqnarray}
書くのが面倒なのでいかついのは１個だけにします. ガウス関数ですね. 統計とか信号処理やるときにでてきます. あとは言わずもがなのオイラーの公式です.\\
\subsubsection{積分}
さて, 微分がわかったとこで積分の気持ちです. パパっといきます.\\
まず, 計算の上でいえる事としては, 微分の逆の操作をするという事です.
\begin{eqnarray}
\int 2x dx= x^2 + C
\end{eqnarray}
こんな具合でしたね. \\
微分とは微小な増分であるdxとdyを用いて変化率を求めるものでしたが, 積分の場合は, dxとyを用いて面積を求める操作になります.\\
\\
関数f(x)は x = a の時, f(a)という値を取り, x = b の時, f(b)という値を取ります. この時xの増分 dx は, ｘ軸での距離を表すので横の長さととらえる事ができ, f(a)あるいはf(b)は縦の長さと考える事ができます.\\
\\
こうして定義される横と縦を用いて作られる長方形を, a～b, b～c, c～d..., m～nといった範囲で同じように作っていき, それぞれの面積をたすと, 関数f(x)とx軸の間の, a～nにおける面積っぽいものがだせますね！\\
しかしこのとき, 横はまだしも縦の長さが問題です. 左端に合わせるのか右端に合わせるのか, あるいはその中点にするのか... これによって求められる面積は理論値から離れた値になってしまいます.\\
\\
この問題を解決するにはどうしたらよいでしょうか？\\
簡単ですね, x軸上での幅を限りなく小さくしていけばよいのです！！\\
\\
横幅が限りなく0に近づいた時, 左端と右端のとる高さは同じ値となるため, 微小長方形の形も関数f(x)にそったものになるはずです.\\
\\
そしてそれらを足し合わせれば, デコボコではなく滑らかな, 関数f(x)の凹凸にあった面積を導出する事が出来るのです！！！
\begin{eqnarray}
\int_a^b f(x) dx
\end{eqnarray}
とはつまり...\\
xがaからbの範囲において, それぞれの f(x) = 高さと 微小なdx = 幅をかけたもの = 面積を足し合わせる\\
といった意味になっているのです！！！\\
\subsubsection{足し算としての積分}
積分とは微小面積の足し合わせと言いましたが, 足し算はΣで表されたはずです. 何故∫を使うのでしょうか？\\
\\
答え. Σは離散値の計算にしか使えないからです！\\
\begin{eqnarray}
\sum_{k=1}^{n} k
\end{eqnarray}
この式では, kに入る数字は1からnまでの整数になります. 無限小の幅による微小面積を考えるときにこれでは, 全く意味がないですよね.\\
\\
そこで∫を使うと, 整数に限らずすべての数を足し合わせる事が出来るのです！！\\
素晴らしいですね！！！足し算のアップデートです！！！\\
\\
足し算として積分を使うことは, ここからの数学では, 頻繁に出てくるので是非感覚として理解してください.
\begin{eqnarray}
X(f) &=& \mathcal{F}[x(t)] = \int^{\infty}_{-\infty}x(t)\exp(-j2\pi f)dt \\
 x(t) &=& \mathcal{F}^{-1}[X(f)] = \int^{\infty}_{-\infty}X(f)\exp(j2\pi f)dt 
\end{eqnarray}
たとえばこいつらは複素フーリエ変換とその逆変換の式ですが, これらもx(t)とexpなんたらの掛け算の-∞から∞での総和とかのように解釈する事ができるわけです！！！\\
これが積分を学ぶ意味です.
\end{document}